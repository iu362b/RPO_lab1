{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ngavr\\\\IdeaProjects\\\\backend\\\\front\\\\src\\\\components\\\\MyAccountComponent.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport BackendService from '../services/BackendService';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faChevronLeft } from \"@fortawesome/free-solid-svg-icons\";\nimport { connect, useDispatch } from \"react-redux\";\nimport { alertActions } from \"../utils/Rdx\";\nimport Utils from \"../utils/Utils\";\nimport { useForm } from \"react-hook-form\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MyAccountComponent = props => {\n  _s();\n\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const {\n    register,\n    handleSubmit,\n    setValue: mySetValue\n  } = useForm();\n  const [show_pwd, setShowPwd] = useState(false);\n  const uid = Utils.getUser().id;\n\n  const onSubmit = data => {\n    console.log(data);\n    let user = {\n      id: uid,\n      login: data.login,\n      email: data.email,\n      password: data.pwd,\n      np: data.pwd2\n    };\n\n    if (validate(data)) {\n      BackendService.updateUser(user).then(() => {\n        navigate(\"users/\");\n      }).catch(() => {});\n    }\n  };\n\n  useEffect(() => {\n    BackendService.retrieveUser(uid).then(response => {\n      mySetValue(\"login\", response.data.login);\n      mySetValue(\"email\", response.data.email);\n    }).catch(() => {});\n  }, []);\n\n  const onSetPasswordClick = () => {\n    setShowPwd(true);\n  };\n\n  const validate = values => {\n    let e = null;\n\n    if (values.pwd) {\n      if (values.pwd2.length < 8) e = 'Длина пароля должна быть не меньше 8 символов';else if (!values.pwd2) e = 'Пожалуйста повторите ввод пароля';else if (values.pwd !== values.pwd2) e = 'Пароли не совпадают';\n    }\n\n    if (e != null) {\n      dispatch(alertActions.error(e));\n      return false;\n    }\n\n    return true;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"m-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row my-2\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u041C\\u043E\\u0439 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit),\n        children: [/*#__PURE__*/_jsxDEV(\"fieldset\", {\n          className: \"form-group mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u041B\\u043E\\u0433\\u0438\\u043D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", { ...register(\"login\"),\n            className: \"form-control\",\n            type: \"text\",\n            disabled: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          className: \"form-group mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"EMail\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", { ...register(\"email\"),\n            className: \"form-control\",\n            type: \"text\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this), show_pwd && /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          className: \"form-group mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-control\",\n            type: \"password\",\n            ...register(\"pwd\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 29\n        }, this), show_pwd && /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          className: \"form-group-mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u041F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-control\",\n            type: \"password\",\n            ...register(\"pwd2\", {\n              minLength: 8\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 25\n        }, this), !show_pwd && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-outline-secondary mt-2\",\n            onClick: onSetPasswordClick,\n            children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 38\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          className: \"btn btn-outline-secondary mt-2\",\n          value: \"Сохранить\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MyAccountComponent, \"d3TDUGCCrvH8JtmbfLWF7jFAOhA=\", false, function () {\n  return [useNavigate, useDispatch, useForm];\n});\n\n_c = MyAccountComponent;\nexport default connect()(MyAccountComponent);\n\nvar _c;\n\n$RefreshReg$(_c, \"MyAccountComponent\");","map":{"version":3,"names":["React","useEffect","useState","BackendService","FontAwesomeIcon","faChevronLeft","connect","useDispatch","alertActions","Utils","useForm","useNavigate","MyAccountComponent","props","navigate","dispatch","register","handleSubmit","setValue","mySetValue","show_pwd","setShowPwd","uid","getUser","id","onSubmit","data","console","log","user","login","email","password","pwd","np","pwd2","validate","updateUser","then","catch","retrieveUser","response","onSetPasswordClick","values","e","length","error","minLength"],"sources":["C:/Users/ngavr/IdeaProjects/backend/front/src/components/MyAccountComponent.jsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport BackendService from '../services/BackendService';\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faChevronLeft} from \"@fortawesome/free-solid-svg-icons\";\r\nimport {connect, useDispatch} from \"react-redux\";\r\nimport {alertActions} from \"../utils/Rdx\";\r\nimport Utils from \"../utils/Utils\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport {useNavigate} from \"react-router-dom\";\r\n\r\nconst MyAccountComponent = props => {\r\n    const navigate = useNavigate();\r\n    const dispatch = useDispatch()\r\n    const {register, handleSubmit, setValue : mySetValue } = useForm();\r\n    const [show_pwd, setShowPwd] = useState(false);\r\n    const uid = Utils.getUser().id;\r\n    const onSubmit = data => {\r\n        console.log(data);\r\n        let user = {\r\n            id: uid,\r\n            login: data.login,\r\n            email: data.email,\r\n            password: data.pwd,\r\n            np: data.pwd2\r\n        }\r\n\r\n        if (validate(data)) {\r\n            BackendService.updateUser(user)\r\n            .then(() => {\r\n                navigate(\"users/\");\r\n            })\r\n            .catch(() => {\r\n            })\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        BackendService.retrieveUser(uid)\r\n        .then(response => {\r\n            mySetValue(\"login\", response.data.login);\r\n            mySetValue(\"email\", response.data.email);\r\n        })\r\n        .catch(() => {\r\n        })\r\n    }, []);\r\n\r\n    const onSetPasswordClick = () => {\r\n        setShowPwd(true );\r\n    }\r\n\r\n    const validate = values => {\r\n        let e = null\r\n        if (values.pwd) {\r\n            if (values.pwd2.length < 8)\r\n                e = 'Длина пароля должна быть не меньше 8 символов'\r\n            else if (!values.pwd2)\r\n                e = 'Пожалуйста повторите ввод пароля'\r\n            else if (values.pwd !== values.pwd2)\r\n                e = 'Пароли не совпадают'\r\n        }\r\n        if (e != null) {\r\n            dispatch(alertActions.error(e))\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    return (\r\n        <div className=\"m-4\">\r\n            <div className=\"container\">\r\n                <div className=\"row my-2\">\r\n                    <h3>Мой аккаунт</h3>\r\n                </div>\r\n                <form onSubmit={handleSubmit(onSubmit)}>\r\n                    <fieldset className=\"form-group mt-2\">\r\n                        <label>Логин</label>\r\n                        <input {...register(\"login\")} className=\"form-control\" type=\"text\" disabled/>\r\n                    </fieldset>\r\n                    <fieldset className=\"form-group mt-2\" >\r\n                        <label>EMail</label>\r\n                        <input {...register(\"email\")} className=\"form-control\" type=\"text\"/>\r\n                    </fieldset>\r\n                    {\r\n                        show_pwd &&\r\n                            <fieldset className=\"form-group mt-2\">\r\n                                <label>Введите пароль</label>\r\n                                <input className=\"form-control\" type=\"password\" {...register(\"pwd\")}/>\r\n                            </fieldset>\r\n                    }\r\n                    {\r\n                        show_pwd &&\r\n                        <fieldset className=\"form-group-mt-2\">\r\n                            <label>Повторите пароль</label>\r\n                            <input className=\"form-control\" type=\"password\" {...register(\"pwd2\", {minLength: 8})}/>\r\n                        </fieldset>\r\n                    }\r\n                    {\r\n                        !show_pwd && <div>\r\n                            <button className=\"btn btn-outline-secondary mt-2\"\r\n                                onClick={onSetPasswordClick}>Изменить пароль\r\n                            </button>\r\n                          </div>\r\n                    }\r\n\r\n                   <input type=\"submit\" className=\"btn btn-outline-secondary mt-2\" value={\"Сохранить\"}/>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default connect()(MyAccountComponent);"],"mappings":"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"},"metadata":{},"sourceType":"module"}