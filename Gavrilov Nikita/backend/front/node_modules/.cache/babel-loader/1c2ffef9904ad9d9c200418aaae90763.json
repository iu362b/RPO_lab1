{"ast":null,"code":"import axios from 'axios';\nimport Utils from \"../utils/Utils\";\nimport { alertActions, store } from \"../utils/Rdx\";\nconst API_URL = 'http://localhost:8081/api/v1';\nconst AUTH_URL = 'http://localhost:8081/auth';\n\nclass BackendService {\n  login(login, password) {\n    return axios.post(`${AUTH_URL}/login`, {\n      login,\n      password\n    });\n  }\n\n  logout() {\n    return axios.get(`${AUTH_URL}/logout`, {\n      /* headers : {Authorization : Utils.getToken()} */\n    });\n  }\n\n}\n\nfunction showError(msg) {\n  store.dispatch(alertActions.error(msg));\n}\n\naxios.interceptors.request.use(config => {\n  store.dispatch(alertActions.clear());\n  let token = Utils.getToken();\n  if (token) config.headers.Authorization = token;\n  return config;\n}, error => {\n  showError(error.message);\n  return Promise.reject(error);\n});\naxios.interceptors.response.use(undefined, error => {\n  if (error.response && error.response.status && [401, 403].indexOf(error.response.status) !== -1) showError(\"Ошибка авторизации\");else if (error.response && error.response.data && error.response.data.message) showError(error.response.data.message);else showError(error.message);\n  return Promise.reject(error);\n});\nexport default new BackendService();","map":{"version":3,"names":["axios","Utils","alertActions","store","API_URL","AUTH_URL","BackendService","login","password","post","logout","get","showError","msg","dispatch","error","interceptors","request","use","config","clear","token","getToken","headers","Authorization","message","Promise","reject","response","undefined","status","indexOf","data"],"sources":["C:/Users/ngavr/IdeaProjects/backend/front/src/services/BackendService.jsx"],"sourcesContent":["import axios from 'axios'\r\nimport Utils from \"../utils/Utils\";\r\nimport {alertActions, store} from \"../utils/Rdx\";\r\n\r\nconst API_URL = 'http://localhost:8081/api/v1'\r\nconst AUTH_URL = 'http://localhost:8081/auth'\r\n\r\nclass BackendService {\r\n\r\n    login(login, password) {\r\n        return axios.post(`${AUTH_URL}/login`, {login, password})\r\n    }\r\n\r\n    logout() {\r\n\t\treturn axios.get(`${AUTH_URL}/logout`, { /* headers : {Authorization : Utils.getToken()} */})\r\n\t}\r\n}\r\n\r\nfunction showError(msg)\r\n{\r\n    store.dispatch(alertActions.error(msg))\r\n}\r\n\r\naxios.interceptors.request.use(\r\n    config => {\r\n        store.dispatch(alertActions.clear())\r\n        let token = Utils.getToken();\r\n        if (token)\r\n            config.headers.Authorization = token;\r\n        return config;\r\n    },\r\n    error => {\r\n        showError(error.message)\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\naxios.interceptors.response.use(undefined,\r\n    error => {\r\n        if (error.response && error.response.status && [401, 403].indexOf(error.response.status) !== -1)\r\n            showError(\"Ошибка авторизации\")\r\n        else if (error.response && error.response.data && error.response.data.message)\r\n            showError(error.response.data.message)\r\n        else\r\n            showError(error.message)\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\nexport default new BackendService()"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;AACA,SAAQC,YAAR,EAAsBC,KAAtB,QAAkC,cAAlC;AAEA,MAAMC,OAAO,GAAG,8BAAhB;AACA,MAAMC,QAAQ,GAAG,4BAAjB;;AAEA,MAAMC,cAAN,CAAqB;EAEjBC,KAAK,CAACA,KAAD,EAAQC,QAAR,EAAkB;IACnB,OAAOR,KAAK,CAACS,IAAN,CAAY,GAAEJ,QAAS,QAAvB,EAAgC;MAACE,KAAD;MAAQC;IAAR,CAAhC,CAAP;EACH;;EAEDE,MAAM,GAAG;IACX,OAAOV,KAAK,CAACW,GAAN,CAAW,GAAEN,QAAS,SAAtB,EAAgC;MAAE;IAAF,CAAhC,CAAP;EACA;;AARmB;;AAWrB,SAASO,SAAT,CAAmBC,GAAnB,EACA;EACIV,KAAK,CAACW,QAAN,CAAeZ,YAAY,CAACa,KAAb,CAAmBF,GAAnB,CAAf;AACH;;AAEDb,KAAK,CAACgB,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACIC,MAAM,IAAI;EACNhB,KAAK,CAACW,QAAN,CAAeZ,YAAY,CAACkB,KAAb,EAAf;EACA,IAAIC,KAAK,GAAGpB,KAAK,CAACqB,QAAN,EAAZ;EACA,IAAID,KAAJ,EACIF,MAAM,CAACI,OAAP,CAAeC,aAAf,GAA+BH,KAA/B;EACJ,OAAOF,MAAP;AACH,CAPL,EAQIJ,KAAK,IAAI;EACLH,SAAS,CAACG,KAAK,CAACU,OAAP,CAAT;EACA,OAAOC,OAAO,CAACC,MAAR,CAAeZ,KAAf,CAAP;AACH,CAXL;AAcAf,KAAK,CAACgB,YAAN,CAAmBY,QAAnB,CAA4BV,GAA5B,CAAgCW,SAAhC,EACId,KAAK,IAAI;EACL,IAAIA,KAAK,CAACa,QAAN,IAAkBb,KAAK,CAACa,QAAN,CAAeE,MAAjC,IAA2C,CAAC,GAAD,EAAM,GAAN,EAAWC,OAAX,CAAmBhB,KAAK,CAACa,QAAN,CAAeE,MAAlC,MAA8C,CAAC,CAA9F,EACIlB,SAAS,CAAC,oBAAD,CAAT,CADJ,KAEK,IAAIG,KAAK,CAACa,QAAN,IAAkBb,KAAK,CAACa,QAAN,CAAeI,IAAjC,IAAyCjB,KAAK,CAACa,QAAN,CAAeI,IAAf,CAAoBP,OAAjE,EACDb,SAAS,CAACG,KAAK,CAACa,QAAN,CAAeI,IAAf,CAAoBP,OAArB,CAAT,CADC,KAGDb,SAAS,CAACG,KAAK,CAACU,OAAP,CAAT;EACJ,OAAOC,OAAO,CAACC,MAAR,CAAeZ,KAAf,CAAP;AACH,CATL;AAYA,eAAe,IAAIT,cAAJ,EAAf"},"metadata":{},"sourceType":"module"}